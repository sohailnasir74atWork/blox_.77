apply plugin: "com.android.application"
apply plugin: "org.jetbrains.kotlin.android"
apply plugin: "com.facebook.react"
apply from: file("../../node_modules/react-native-vector-icons/fonts.gradle")

react { autolinkLibrariesWithApp() }

def enableProguardInReleaseBuilds = true

/**
 * The preferred build flavor of JavaScriptCore (JSC)
 *
 * For example, to use the international variant, you can use:
 * `def jscFlavor = 'org.webkit:android-jsc-intl:+'`
 *
 * The international variant includes ICU i18n library and necessary data
 * allowing to use e.g. `Date.toLocaleString` and `String.localeCompare` that
 * give correct results when using with locales other than en-US. Note that
 * this variant is about 6MiB larger per architecture than default.
 */
def jscFlavor = 'io.github.react-native-community:jsc-android:2026004.+'

android {
  ndkVersion rootProject.ext.ndkVersion
    buildToolsVersion rootProject.ext.buildToolsVersion
  compileSdk rootProject.ext.compileSdkVersion

  namespace "com.bloxfruitevalues"
  defaultConfig {
    applicationId "com.bloxfruitevalues"
    minSdkVersion rootProject.ext.minSdkVersion
    targetSdkVersion rootProject.ext.targetSdkVersion
    versionCode 89
    versionName "3.4.5"
    ndk {
      abiFilters "arm64-v8a", "armeabi-v7a" // single declaration
    }
  }

  
  packaging {
    jniLibs { excludes += ["**/x86/**", "**/x86_64/**"] }
  }

  signingConfigs {
    release {
      // ⚠️ move these to gradle.properties or env vars
      storeFile file('solanalab.keystore')
      storePassword '798702'
      keyAlias 'solanalabdev'
      keyPassword '798702'
    }
  }

  buildTypes {
    debug { signingConfig signingConfigs.debug }
    release {
      signingConfig signingConfigs.release
      minifyEnabled enableProguardInReleaseBuilds
      proguardFiles getDefaultProguardFile("proguard-android.txt"), "proguard-rules.pro"
    }
  }
}

// ---- Fix the WorkManager version clash ----


dependencies {
  implementation("com.facebook.react:react-android")

  // JS engine
  if (hermesEnabled.toBoolean()) {
    implementation("com.facebook.react:hermes-android")
  } else {
   implementation jscFlavor
  }

  // --- AdMob + Unity mediation (ALWAYS present) ---
  implementation platform("com.google.firebase:firebase-bom:33.5.1")
  implementation "com.google.firebase:firebase-analytics"
  implementation "com.google.firebase:firebase-messaging"
  implementation "com.google.firebase:firebase-crashlytics"

  implementation "com.google.android.gms:play-services-ads:23.5.0"   // OK; Gradle may hoist to 24.x
  implementation "com.unity3d.ads:unity-ads:4.16.2"
  implementation "com.google.ads.mediation:unity:4.16.3.0"
  implementation "com.google.android.ump:user-messaging-platform:2.2.0"
  // (optional, but I’d keep it) WorkManager alignment you added earlier
  implementation "androidx.work:work-runtime-ktx:2.8.0"
}


apply plugin: 'com.google.gms.google-services'
apply plugin: 'com.google.firebase.crashlytics'
